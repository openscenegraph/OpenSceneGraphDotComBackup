<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] Building for platform without threads?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Building%20for%20platform%20without%20threads%3F&In-Reply-To=%3Cmailman.80381.1585757540.7168.osg-users-openscenegraph.org%40lists.openscenegraph.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="010929.html">
   <LINK REL="Next"  HREF="010931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] Building for platform without threads?</H1>
<!--htdig_noindex-->
    <B>OpenSceneGraph Users</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Building%20for%20platform%20without%20threads%3F&In-Reply-To=%3Cmailman.80381.1585757540.7168.osg-users-openscenegraph.org%40lists.openscenegraph.org%3E"
       TITLE="[osg-users] Building for platform without threads?">osg-users at lists.openscenegraph.org
       </A><BR>
    <I>Wed Apr  1 09:12:06 PDT 2020</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="010929.html">[osg-users] Projection Mode
</A></li>
        <LI>Next message (by thread): <A HREF="010931.html">[osg-users]  www.openscenegraph.org is down?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10930">[ date ]</a>
              <a href="thread.html#10930">[ thread ]</a>
              <a href="subject.html#10930">[ subject ]</a>
              <a href="author.html#10930">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi, Phil,

I have a small sample with single threaded osgViewer that might help
you: <A HREF="https://github.com/OGStudio/openscenegraph-cross-platform-guide/tree/master/1.10.SampleWeb">https://github.com/OGStudio/openscenegraph-cross-platform-guide/tree/master/1.10.SampleWeb</A>
OSG sources host the same Emscripten sample. Though, compile time
flags might need just a bit of tweaking (see
openscenegraph-cross-platform-guide open issues).

Regards,
Michael.

On Tue, 31 Mar 2020 at 02:35, OpenSceneGraph Users
&lt;<A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> The issue is actually before anything runs, it&#8217;s link-time errors (in this case, linking the compiled WebAssembly). OpenThreads uses the standard FindThreads.cmake module, which in the case of WebAssembly still finds the pthreads headers, but at link time no pthreads libraru is available so the pthreads symbols can&#8217;t be resolved.
</I>&gt;<i>
</I>&gt;<i> I don&#8217;t recall if I mentioned earlier, but the multi-threaded version works just fine in multi-threaded WebAssembly. This depends on SharedArrayBuffer support in Javascript, which has been disabled in many browsers to mitigate spectre-style attacks. So I&#8217;m trying to support the single-threaded case as well to support those browsers. This is primarily on mobile platforms.
</I>&gt;<i>
</I>&gt;<i> I guess to build a usable single-threaded version, what is needed is a patch to OpenThreads to ignore all pthreads headers, and effectively stub-out some of the methods. In single-threaded WebAssembly there are apparently still gcc-style internals available for atomics, so it wouldn&#8217;t be necessary to create new code for all stubs.
</I>&gt;<i>
</I>&gt;<i> Kind regards,
</I>&gt;<i> Phil.
</I>&gt;<i>
</I>&gt;<i> &gt; On 30/03/2020, at 10:22 PM, OpenSceneGraph Users &lt;<A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hi, Phil,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; when you run single threaded osgViewer, you have single thread. Which
</I>&gt;<i> &gt; browsers don't like that and why?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt; Michael.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> osg-users mailing list
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org</A>
</I></PRE>


<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="010929.html">[osg-users] Projection Mode
</A></li>
	<LI>Next message (by thread): <A HREF="010931.html">[osg-users]  www.openscenegraph.org is down?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10930">[ date ]</a>
              <a href="thread.html#10930">[ thread ]</a>
              <a href="subject.html#10930">[ subject ]</a>
              <a href="author.html#10930">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

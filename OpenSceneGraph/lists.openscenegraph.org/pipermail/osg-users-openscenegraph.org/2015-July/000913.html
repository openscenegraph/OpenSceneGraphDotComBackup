<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] OpenSceneGraph-3.4.0-rc6 tagged
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20OpenSceneGraph-3.4.0-rc6%20tagged&In-Reply-To=%3CCAFN7Y%2BWnwUEuXpe0Qvtt05%2BGdVde3XW-m71krAc1r%3Dt6GN6v%3Dg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000912.html">
   <LINK REL="Next"  HREF="000919.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] OpenSceneGraph-3.4.0-rc6 tagged</H1>
<!--htdig_noindex-->
    <B>Robert Osfield</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20OpenSceneGraph-3.4.0-rc6%20tagged&In-Reply-To=%3CCAFN7Y%2BWnwUEuXpe0Qvtt05%2BGdVde3XW-m71krAc1r%3Dt6GN6v%3Dg%40mail.gmail.com%3E"
       TITLE="[osg-users] OpenSceneGraph-3.4.0-rc6 tagged">robert.osfield at gmail.com
       </A><BR>
    <I>Thu Jul 23 03:32:54 PDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="000912.html">[osg-users] OpenSceneGraph-3.4.0-rc6 tagged
</A></li>
        <LI>Next message: <A HREF="000919.html">[osg-users] OpenSceneGraph-3.4.0-rc6 tagged
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#913">[ date ]</a>
              <a href="thread.html#913">[ thread ]</a>
              <a href="subject.html#913">[ subject ]</a>
              <a href="author.html#913">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Pjotr,

Thanks for testing with VS2015 and reporting the warnings.  I don't have
VS2015 so can't test any fixes myself, could you have a bash at fixing the
warnings and send me the changes, I can then review.

Currently I'm working on addressing warnings generated by clang 3.6, it's
pretty strict but hasn't reported the same warnings as VS2015.

Cheers,
Robert.

On 23 July 2015 at 11:12, Pjotr Svetachov &lt;<A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">pjotrsvetachov at gmail.com</A>&gt; wrote:

&gt;<i> Hi Robert,
</I>&gt;<i>
</I>&gt;<i> Testing with the newly released VS2015 produced these 4 warnings for each
</I>&gt;<i> file that includes (directly or indirectly) osg/GraphicsThread this will
</I>&gt;<i> lead to hundreds of warnings:
</I>&gt;<i> 1&gt;I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(55):
</I>&gt;<i> warning C4589: Constructor of abstract class 'osg::Operation' ignores
</I>&gt;<i> initializer for virtual base class 'osg::Referenced'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(55):
</I>&gt;<i> note: virtual base classes are only initialized by the most-derived type
</I>&gt;<i> 1&gt;I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(81):
</I>&gt;<i> warning C4589: Constructor of abstract class 'osg::Operation' ignores
</I>&gt;<i> initializer for virtual base class 'osg::Referenced'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(81):
</I>&gt;<i> note: virtual base classes are only initialized by the most-derived type
</I>&gt;<i> 1&gt;I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(85):
</I>&gt;<i> warning C4589: Constructor of abstract class 'osg::Operation' ignores
</I>&gt;<i> initializer for virtual base class 'osg::Referenced'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/OperationThread(85):
</I>&gt;<i> note: virtual base classes are only initialized by the most-derived type
</I>&gt;<i> 1&gt;I:\Libraries\OpenSceneGraphTrunk\include\osg/GraphicsThread(45): warning
</I>&gt;<i> C4589: Constructor of abstract class 'osg::GraphicsOperation' ignores
</I>&gt;<i> initializer for virtual base class 'osg::Referenced'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/GraphicsThread(45): note:
</I>&gt;<i> virtual base classes are only initialized by the most-derived type
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/GraphicsThread(45): note:
</I>&gt;<i> This diagnostic occurred in the compiler generated function
</I>&gt;<i> 'osg::GraphicsOperation::GraphicsOperation(const osg::GraphicsOperation &amp;)'
</I>&gt;<i>
</I>&gt;<i> Trying to find out what is really happening I stumbled on this:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://stackoverflow.com/questions/10534228/order-of-constructor-call-in-virtual-inheritance">http://stackoverflow.com/questions/10534228/order-of-constructor-call-in-virtual-inheritance</A>
</I>&gt;<i>
</I>&gt;<i> The first three warnings come from this:
</I>&gt;<i> The problem is that the Operation class is virtually inheriting from the
</I>&gt;<i> class Referenced. The constructors and copy constructors of the class
</I>&gt;<i> Operation call Referenced(true). Now, with virtual inheritance the
</I>&gt;<i> constructors of virtual base classes are always called from the most
</I>&gt;<i> derived class. Now what Visual Studio is complaining about is that
</I>&gt;<i> Operations is a abstract class so you can not construct an instance of it
</I>&gt;<i> directly. You need to inherit from it, implement the abstract methods and
</I>&gt;<i> construct the derived class. So the call to Referenced(true) will never
</I>&gt;<i> happen inside the Operation constructors. Instead you need to add this call
</I>&gt;<i> to the most derived classes of Operation. If you don't do this it will call
</I>&gt;<i> the default constructor Referenced::Referenced() instead of
</I>&gt;<i> Referenced::Referenced(true).
</I>&gt;<i> I did a search to see whats inheriting from Operation and found a few
</I>&gt;<i> cases. For example BlockAndFlushOperation and
</I>&gt;<i> ReleaseContext_Block_MakeCurrentOperation do not call Referenced(true) in
</I>&gt;<i> their constructors so then the default constructor Referenced() is called.
</I>&gt;<i>
</I>&gt;<i> The 4th warning comes from that visual studio makes a default constructor
</I>&gt;<i> for GraphicsOperation that calls Referenced() and then complains about it,
</I>&gt;<i> this is probably a bug in vs2015, see also:
</I>&gt;<i> <A HREF="https://connect.microsoft.com/VisualStudio/feedback/details/1570496/vs-2015-generates-a-copy-constructor-and-then-complains-about-it">https://connect.microsoft.com/VisualStudio/feedback/details/1570496/vs-2015-generates-a-copy-constructor-and-then-complains-about-it</A>
</I>&gt;<i>
</I>&gt;<i> The same is happening for the class ViewerBase because it is using virtual
</I>&gt;<i> inheritance to derive from Object and calling Object(true) from the
</I>&gt;<i> constructor.
</I>&gt;<i> For ViewerBase I even got an error:
</I>&gt;<i> 1&gt;I:\Libraries\OpenSceneGraphTrunk\include\osgViewer/ViewerBase(340):
</I>&gt;<i> error C2249: 'osg::Object::operator =': no accessible path to private
</I>&gt;<i> member declared in virtual base 'osg::Object'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/Object(238): note: see
</I>&gt;<i> declaration of 'osg::Object::operator ='
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osg/Object(56): note: see
</I>&gt;<i> declaration of 'osg::Object'
</I>&gt;<i> 1&gt;  I:\Libraries\OpenSceneGraphTrunk\include\osgViewer/ViewerBase(340):
</I>&gt;<i> note: This diagnostic occurred in the compiler generated function
</I>&gt;<i> 'osgViewer::ViewerBase &amp;osgViewer::ViewerBase::operator =(const
</I>&gt;<i> osgViewer::ViewerBase &amp;)'
</I>&gt;<i> But this looks like the bug in visual studio from above but this time it
</I>&gt;<i> makes a default copy operator for ViewerBase that tries to call the private
</I>&gt;<i> copy operator of Object from the generated default copy operator. It might
</I>&gt;<i> be an bug in the compiler or it might be by a genuine error (I don't know
</I>&gt;<i> the specs of c++ that well:) ) but a workaround for this error is to add:
</I>&gt;<i>
</I>&gt;<i> Code:
</I>&gt;<i>
</I>&gt;<i> private:
</I>&gt;<i> ViewerBase&amp; operator = (const ViewerBase&amp;) { return *this; }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> At the end of the ViewerBase class. (At least if that is the intended
</I>&gt;<i> behavior)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Pjotr
</I>&gt;<i>
</I>&gt;<i> ------------------
</I>&gt;<i> Read this topic online here:
</I>&gt;<i> <A HREF="../../../../forum.openscenegraph.org/viewtopic375d.php?p=64443#64443">http://forum.openscenegraph.org/viewtopic.php?p=64443#64443</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> osg-users mailing list
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="../attachments/20150723/33437b33/attachment-0003.html">http://lists.openscenegraph.org/pipermail/osg-users-openscenegraph.org/attachments/20150723/33437b33/attachment-0003.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000912.html">[osg-users] OpenSceneGraph-3.4.0-rc6 tagged
</A></li>
	<LI>Next message: <A HREF="000919.html">[osg-users] OpenSceneGraph-3.4.0-rc6 tagged
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#913">[ date ]</a>
              <a href="thread.html#913">[ thread ]</a>
              <a href="subject.html#913">[ subject ]</a>
              <a href="author.html#913">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

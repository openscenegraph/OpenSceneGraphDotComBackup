<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] [ShaderComposition] Redondant call to useProgram
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20%5BShaderComposition%5D%20Redondant%20call%20to%20useProgram&In-Reply-To=%3CCAFN7Y%2BXD1fz-AXEXk_WczzsPuDO132TVa9Un6JyqTceYzP41pA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="007144.html">
   <LINK REL="Next"  HREF="007175.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] [ShaderComposition] Redondant call to useProgram</H1>
<!--htdig_noindex-->
    <B>Robert Osfield</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20%5BShaderComposition%5D%20Redondant%20call%20to%20useProgram&In-Reply-To=%3CCAFN7Y%2BXD1fz-AXEXk_WczzsPuDO132TVa9Un6JyqTceYzP41pA%40mail.gmail.com%3E"
       TITLE="[osg-users] [ShaderComposition] Redondant call to useProgram">robert.osfield at gmail.com
       </A><BR>
    <I>Mon Nov  6 01:00:42 PST 2017</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="007144.html">[osg-users] [ShaderComposition] Redondant call to useProgram
</A></li>
        <LI>Next message (by thread): <A HREF="007175.html">[osg-users] [ShaderComposition] Redondant call to useProgram
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7155">[ date ]</a>
              <a href="thread.html#7155">[ thread ]</a>
              <a href="subject.html#7155">[ subject ]</a>
              <a href="author.html#7155">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Julien,

I can't provide an answers without digging deeply in the code, this
week I'm really busy with clients so can't look in to.  Next week I'll
be getting back to the shader_pipeline branch and better able to look
into it.

Which version of the OSG are you using?  Is the standard
osgshadercomposition example generating this issue or is it modified
version?  How are you detecting up the redundant calls issue?

Robert.

On 4 November 2017 at 18:03, Julien Valentin &lt;<A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">julienvalentin51 at gmail.com</A>&gt; wrote:
&gt;<i> Hi Robert,
</I>&gt;<i>
</I>&gt;<i> Using the new shader composition (ex osgshadercompostion), I was surprised to detect a lot of redondant call to gluseprogram...
</I>&gt;<i> I debugged a few and don't understand well State::push/popDefine and its policy to invalidate defineMap (defineMap.changed = true; seams to be called at each push/pop)
</I>&gt;<i> (It's difficult to interact since it' s in the header)
</I>&gt;<i>
</I>&gt;<i> The problem seams here since it always tags as changed definemap (and so lead to some useless passage in State.cpp line 672
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Code:
</I>&gt;<i>   if ((_lastAppliedProgramObject!=0) &amp;&amp; (previousLastAppliedProgramObject==_lastAppliedProgramObject) &amp;&amp; _defineMap.changed)
</I>&gt;<i>         {
</I>&gt;<i>             // OSG_NOTICE&lt;&lt;&quot;State::apply(StateSet*) Program already applied (&quot;&lt;&lt;(previousLastAppliedProgramObject==_lastAppliedProgramObject)&lt;&lt;&quot;) and _defineMap.changed= &quot;&lt;&lt;_defineMap.changed&lt;&lt;std::endl;
</I>&gt;<i>             _lastAppliedProgramObject-&gt;getProgram()-&gt;apply(*this);
</I>&gt;<i>         }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hoping this helps you to diagnose the problem :/
</I>&gt;<i>
</I>&gt;<i> Thank you!
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i> Julien
</I>&gt;<i>
</I>&gt;<i> ------------------
</I>&gt;<i> Read this topic online here:
</I>&gt;<i> <A HREF="http://forum.openscenegraph.org/viewtopic.php?p=72306#72306">http://forum.openscenegraph.org/viewtopic.php?p=72306#72306</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> osg-users mailing list
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org</A>
</I></PRE>









<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="007144.html">[osg-users] [ShaderComposition] Redondant call to useProgram
</A></li>
	<LI>Next message (by thread): <A HREF="007175.html">[osg-users] [ShaderComposition] Redondant call to useProgram
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#7155">[ date ]</a>
              <a href="thread.html#7155">[ thread ]</a>
              <a href="subject.html#7155">[ subject ]</a>
              <a href="author.html#7155">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

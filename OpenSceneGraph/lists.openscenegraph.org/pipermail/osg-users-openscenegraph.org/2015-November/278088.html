<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] segfaults with glDeleteShader
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20segfaults%20with%20glDeleteShader&In-Reply-To=%3C1446458126.m2f.65510%40forum.openscenegraph.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="001903.html">
   <LINK REL="Next"  HREF="001866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] segfaults with glDeleteShader</H1>
<!--htdig_noindex-->
    <B>Roman Grigoriev</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20segfaults%20with%20glDeleteShader&In-Reply-To=%3C1446458126.m2f.65510%40forum.openscenegraph.org%3E"
       TITLE="[osg-users] segfaults with glDeleteShader">grigoriev at gosniias.ru
       </A><BR>
    <I>Mon Nov  2 01:55:26 PST 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001903.html">[osg-users] Joystick support in OSG
</A></li>
        <LI>Next message: <A HREF="001866.html">[osg-users] segfaults with glDeleteShader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#278088">[ date ]</a>
              <a href="thread.html#278088">[ thread ]</a>
              <a href="subject.html#278088">[ subject ]</a>
              <a href="author.html#278088">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi, I use osg and osgearth git version under linux  Lubuntu 15.04 nvidia 352 driver.
And got segfaults on delete shaders 

Code:

#0  0x00007ffff34fbe09 in glDeleteShader () from /usr/lib/nvidia-352/libGL.so.1 
#1  0x00007ffff6c8bce5 in osg::Shader::PerContextShader::~PerContextShader() () from /usr/local/lib64/libosg.so.140 
#2  0x00007ffff6c8bf59 in osg::Shader::PerContextShader::~PerContextShader() () from /usr/local/lib64/libosg.so.140 
#3  0x00007ffff6c8c3ae in osg::Shader::ShaderObjects::~ShaderObjects() () from /usr/local/lib64/libosg.so.140 
#4  0x00007ffff6c8ae8d in osg::Shader::releaseGLObjects(osg::State*) const () from /usr/local/lib64/libosg.so.140 
#5  0x00007ffff6c73375 in osg::Program::releaseGLObjects(osg::State*) const () from /usr/local/lib64/libosg.so.140 
#6  0x00007ffff7a8af81 in osgEarth::VirtualProgram::releaseGLObjects(osg::State*) const () from /usr/local/lib64/libosgEarth.so.0 
#7  0x00007ffff7a2eb55 in osgEarth::StateSetCache::prune() () from /usr/local/lib64/libosgEarth.so.0 
#8  0x00007ffff7a2ea0e in osgEarth::StateSetCache::pruneIfNecessary() () from /usr/local/lib64/libosgEarth.so.0 
#9  0x00007ffff7a2e8a5 in osgEarth::StateSetCache::share(osg::ref_ptr&lt;osg::StateAttribute&gt;&amp;, osg::ref_ptr&lt;osg::StateAttribute&gt;&amp;, bool) () from /usr/local/lib64/libosgEarth.so.0 
#10 0x00007ffff7a2db0a in (anonymous namespace)::ShareStateAttributes::applyStateSet(osg::StateSet*) () from /usr/local/lib64/libosgEarth.so.0 
#11 0x00007ffff7a2d89c in (anonymous namespace)::ShareStateAttributes::apply(osg::Node&amp;) () from /usr/local/lib64/libosgEarth.so.0 
#12 0x00007ffff7895ef6 in osg::Group::accept(osg::NodeVisitor&amp;) () from /usr/local/lib64/libosgEarth.so.0 
#13 0x00007ffff7a2e4fd in osgEarth::StateSetCache::consolidateStateAttributes(osg::Node*) () from /usr/local/lib64/libosgEarth.so.0 
#14 0x00007ffff2e84753 in osgEarth::Features::GeometryCompiler::compile(std::list&lt;osg::ref_ptr&lt;osgEarth::Features::Feature&gt;, std::allocator&lt;osg::ref_ptr&lt;osgEarth::Features::Feature&gt; &gt; &gt;&amp;, osgEarth::Symbology::Style const&amp;, osgEarth::Features::FilterContext const&amp;) () from /usr/local/lib64/libosgEarthFeatures.so.0 
#15 0x00007ffff2e825cf in osgEarth::Features::GeometryCompiler::compile(osgEarth::Features::FeatureCursor*, osgEarth::Symbology::Style const&amp;, osgEarth::Features::FilterContext const&amp;) () 
   from /usr/local/lib64/libosgEarthFeatures.so.0 
#16 0x00007ffff2e6563b in osgEarth::Features::GeomFeatureNodeFactory::createOrUpdateNode(osgEarth::Features::FeatureCursor*, osgEarth::Symbology::Style const&amp;, osgEarth::Features::FilterContext const&amp;, osg::ref_ptr&lt;osg::Node&gt;&amp;) () from /usr/local/lib64/libosgEarthFeatures.so.0 
#17 0x00007ffff2e51339 in osgEarth::Features::FeatureModelGraph::createStyleGroup(osgEarth::Symbology::Style const&amp;, std::list&lt;osg::ref_ptr&lt;osgEarth::Features::Feature&gt;, std::allocator&lt;osg::ref_ptr&lt;osgEarth::Features::Feature&gt; &gt; &gt;&amp;, osgEarth::Features::FilterContext const&amp;) () from /usr/local/lib64/libosgEarthFeatures.so.0 
#18 0x00007ffff2e51726 in osgEarth::Features::FeatureModelGraph::createStyleGroup(osgEarth::Symbology::Style const&amp;, osgEarth::Symbology::Query const&amp;, osgEarth::Features::FeatureIndexBuilder*) () 
   from /usr/local/lib64/libosgEarthFeatures.so.0 
#19 0x00007ffff2e4eeed in osgEarth::Features::FeatureModelGraph::buildLevel(osgEarth::Features::FeatureLevel const&amp;, osgEarth::GeoExtent const&amp;, osgEarth::TileKey const*) () 
   from /usr/local/lib64/libosgEarthFeatures.so.0 
#20 0x00007ffff2e4e08a in osgEarth::Features::FeatureModelGraph::load(unsigned int, unsigned int, unsigned int, std::string const&amp;) () from /usr/local/lib64/libosgEarthFeatures.so.0 
#21 0x00007ffff2e55d1a in osgEarthFeatureModelPseudoLoader::readNode(std::string const&amp;, osgDB::Options const*) const () from /usr/local/lib64/libosgEarthFeatures.so.0 
#22 0x00007ffff67ecb73 in osgDB::Registry::ReadNodeFunctor::doRead(osgDB::ReaderWriter&amp;) const () from /usr/local/lib64/libosgDB.so.140 
#23 0x00007ffff67e6903 in osgDB::Registry::read(osgDB::Registry::ReadFunctor const&amp;) () from /usr/local/lib64/libosgDB.so.140 
#24 0x00007ffff67e786f in osgDB::Registry::readImplementation(osgDB::Registry::ReadFunctor const&amp;, osgDB::Options::CacheHintOptions) () from /usr/local/lib64/libosgDB.so.140 
#25 0x00007ffff67e831f in osgDB::Registry::readNodeImplementation(std::string const&amp;, osgDB::Options const*) () from /usr/local/lib64/libosgDB.so.140 
#26 0x00007ffff679a5c6 in osgDB::DatabasePager::DatabaseThread::run() () from /usr/local/lib64/libosgDB.so.140 
#27 0x00007ffff482bb5e in OpenThreads::ThreadPrivateActions::StartThread(void*) () from /usr/local/lib64/libOpenThreads.so.20 
#28 0x00007ffff58c46aa in start_thread (arg=0x7fffc97fa700) at pthread_create.c:333 
#29 0x00007ffff5be1eed in clone () at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109 




So if I comment line 47 in Shader.cpp
        if (extensions-&gt;isGlslSupported) extensions-&gt;glDeleteShader( globj );
and 51 in Program.cpp
        if (extensions-&gt;isGlslSupported) extensions-&gt;glDeleteProgram( globj );
and I don't have segfaults.

It's very easily to reproduse simple run osgearth_viewer with any earth file. 

Thank you!

Cheers,
Roman[/code]

------------------
Read this topic online here:
<A HREF="http://forum.openscenegraph.org/viewtopic.php?p=65510#65510">http://forum.openscenegraph.org/viewtopic.php?p=65510#65510</A>






</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001903.html">[osg-users] Joystick support in OSG
</A></li>
	<LI>Next message: <A HREF="001866.html">[osg-users] segfaults with glDeleteShader
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#278088">[ date ]</a>
              <a href="thread.html#278088">[ thread ]</a>
              <a href="subject.html#278088">[ subject ]</a>
              <a href="author.html#278088">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] Pragmatic shader - a new #pragma directive proposition
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Pragmatic%20shader%20-%20a%20new%20%23pragma%20directive%0A%20proposition&In-Reply-To=%3C5697AA2A.2050903%40ib-caddy.si%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="271976.html">
   <LINK REL="Next"  HREF="271978.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] Pragmatic shader - a new #pragma directive proposition</H1>
<!--htdig_noindex-->
    <B>Robert Milharcic</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Pragmatic%20shader%20-%20a%20new%20%23pragma%20directive%0A%20proposition&In-Reply-To=%3C5697AA2A.2050903%40ib-caddy.si%3E"
       TITLE="[osg-users] Pragmatic shader - a new #pragma directive proposition">robert.milharcic at ib-caddy.si
       </A><BR>
    <I>Thu Jan 14 06:01:14 PST 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="271976.html">[osg-users] Pragmatic shader - a new #pragma directive proposition
</A></li>
        <LI>Next message: <A HREF="271978.html">[osg-users] Pragmatic shader - a new #pragma directive	proposition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#271977">[ date ]</a>
              <a href="thread.html#271977">[ thread ]</a>
              <a href="subject.html#271977">[ subject ]</a>
              <a href="author.html#271977">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Sebastian,

First of all, the lightning shader only illustrates one of the cases where (optionally) repeating a code block containing substitution parameter can be useful. I used the multi-light lightning as an illustration only.

&gt;&gt;<i> First, thank you for your input. Yes, that is more or less the same approach I'm currently using. The downside of this approach is that it requires additional nontrivial code logic for the uniform array management (u_LightColor) and that is why I started to look at the alternatives.
</I>&gt;<i> What could be more complicated there than to setup individual uniforms? Sorry this doesn't pass as a valid argument. If you have to hold the number of used lights somewhere you can hold a reference to the uniform as well.
</I>&gt;<i>
</I>
Sorry, but that is not what I had in mind.  The problem here is the management of the array uniform's content and not the reference to it or the light count etc. Let say I only want to disable one of the lights, say LIGHT0 eg. stateset-&gt;setDefines(&quot;LIGHT0&quot;, osg::StateAttribute::OFF). What will you do?

&gt;&gt;<i> There is also an upper limit for the size of the array that needs to be taken into account. 
</I>&gt;<i> At least 512. If this is not enough you can use Uniform buffer objects (UBO)[1] or Shader Storage Blocks[2] which support
</I>&gt;<i> If this is not enough for your light-count you will probably hit performance problems first.
</I>&gt;<i>
</I>
Yes, that is true. The upper limit is not a problem for this specific multi-light problem.

&gt;&gt;<i> Also, the loop represents unnecessary overhead (though, this is not a problem on a never hardware). 
</I>&gt;<i> That's an assumption of yours. Usually constant folded loops with single return and without break, continue-statements are unrolled by the compiler.
</I>&gt;<i> I'll accept performance comparisons however ;)
</I>&gt;<i>
</I>
Yes, you are right about that. The constant loop will most probably be unrolled by the compiler. Of courses, that is another assumption on top of the previous assumption :)

&gt;&gt;<i> On the other hand, my suggestion fits well into existing pragmatic shader composition logic and probably has less downsides.
</I>&gt;&gt;<i>
</I>&gt;<i> Downside is that you're trying to invent a meta-language here out of reasons that I commented on. The downside of your approach is a preprocessor language with no clear advantages over the tools already at your disposal.
</I>&gt;<i> So to say, the current language is already turing-complete and you're trying to put some syntactic sugar on top, which adds some high degree of complexity to the parser and to the shader-code.
</I>&gt;<i>
</I>Exactly, that was my intention, to add a higher degree of complexity and hopefully solve some problems that &quot;turing-complete&quot; language can't.

&gt;<i> An alternative for you is to manage this part yourself by simply overriding the parts managing the define-states. Maybe Robert O. can fill in on the details here.
</I>&gt;<i>
</I>&gt;<i> Cheers
</I>&gt;<i> Sebastian
</I>&gt;<i>
</I>
Cheers,
Robert Milharcic
</PRE>






<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="271976.html">[osg-users] Pragmatic shader - a new #pragma directive proposition
</A></li>
	<LI>Next message: <A HREF="271978.html">[osg-users] Pragmatic shader - a new #pragma directive	proposition
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#271977">[ date ]</a>
              <a href="thread.html#271977">[ thread ]</a>
              <a href="subject.html#271977">[ subject ]</a>
              <a href="author.html#271977">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

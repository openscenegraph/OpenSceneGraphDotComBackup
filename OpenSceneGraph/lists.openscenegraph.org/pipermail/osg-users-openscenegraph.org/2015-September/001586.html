<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20INVALID_OPERATION%20with%20compressed%20textures%20with%20mipmaps%0A%20in%20OSG%203.4.0.&In-Reply-To=%3C2E4E20102CFA484082AAB6A7713A83341399F492%40NAEAPAXRXM04V.nadsusea.nads.navy.mil%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="277805.html">
   <LINK REL="Next"  HREF="001589.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.</H1>
<!--htdig_noindex-->
    <B>Davis, Timothy S CTR comnavairsyscom</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20INVALID_OPERATION%20with%20compressed%20textures%20with%20mipmaps%0A%20in%20OSG%203.4.0.&In-Reply-To=%3C2E4E20102CFA484082AAB6A7713A83341399F492%40NAEAPAXRXM04V.nadsusea.nads.navy.mil%3E"
       TITLE="[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.">timothy.s.davis.ctr at navy.mil
       </A><BR>
    <I>Wed Sep 23 14:24:57 PDT 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="277805.html">[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.
</A></li>
        <LI>Next message: <A HREF="001589.html">[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1586">[ date ]</a>
              <a href="thread.html#1586">[ thread ]</a>
              <a href="subject.html#1586">[ subject ]</a>
              <a href="author.html#1586">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Robert

Sorry for the bad posting of my last message.  I'll repeat here and update with new information.

The code in question was added sometime during OSG 3.3.x development.  It was not in OSG 3.2.1.  I just recently jumped from 3.2.1 to 3.4.0 for my application which is when I ran into the problem.  It worked fine with OSG 3.2.1.  In particular, it appears to be the added support for texture storage objects and not specifically &quot;compressed texture support&quot;.  I noted the call that gave the error was glCompressTexSubImage2D.  However I should point out that I determined this using gDEBugger.  My version doesn't seem to understand the texture storage extension.  So the error may have been generated by the earlier call to setup the texture storage.  I checked into this and indeed an INVALID_OPERATION was generated by the call to glTexStorage2D. 

In addition, on my machine the problem doesn't affect all compressed textures with mipmaps.  The model that first caused the problem had several such textures, but only a small 32x32 texture resulted in a problem.  I have no idea why this would be the case.  However I remember others reporting issues with loading DDS textures and working around it by commenting out the following line in ReaderWriterDDS:
If ( mipmap_offset.size()&gt;0) osgImage-&gt;setMipmapLevels(mipmap_offsets);
Commenting that line out would appear to disable mipmaps for compressed textures and avoid the problems I've indicated.  This older problem was reported only on OSX, but may be related.  This type of changed made to the IVE loader would also have fixed my problem at the expense of disabling mipmaps.

Looking at a different model, the one problem texture was 128x128.  So there appears to be nothing special about the size.  I did see that the rendering result for the models that have the problem is different between using the fixed-function pipeline and a shader.  With the FFP, the rendering appears correct, though the INVALID_OPERATION error is generated.  With a shader, the textures rendered black.

I looked at making a simple model that would reproduce the problem.  However, I've failed to create such a model.  It just always works with no render problems or OpenGL errors.

For my application, I've worked around the problem by reducing the number of mipmap levels to avoid using levels smaller than the compression block size.  So I consider the problem fixed for me.  However, I feel this is information that you and the rest of the community can use.


Scott

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 5651 bytes
Desc: not available
URL: &lt;<A HREF="../attachments/20150923/8de70b3f/attachment-0003.bin">http://lists.openscenegraph.org/pipermail/osg-users-openscenegraph.org/attachments/20150923/8de70b3f/attachment-0003.bin</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="277805.html">[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.
</A></li>
	<LI>Next message: <A HREF="001589.html">[osg-users] INVALID_OPERATION with compressed textures with mipmaps in OSG 3.4.0.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1586">[ date ]</a>
              <a href="thread.html#1586">[ thread ]</a>
              <a href="subject.html#1586">[ subject ]</a>
              <a href="author.html#1586">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] Regression caused by OSG_PROVIDE_READFILE change
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Regression%20caused%20by%20OSG_PROVIDE_READFILE%20change&In-Reply-To=%3CCAFN7Y%2BW82bXX-v8mZNAVgtCgnsNejPXeCuev%2Bmd9G-6LY06i3Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="278828.html">
   <LINK REL="Next"  HREF="002607.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] Regression caused by OSG_PROVIDE_READFILE change</H1>
<!--htdig_noindex-->
    <B>Robert Osfield</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Regression%20caused%20by%20OSG_PROVIDE_READFILE%20change&In-Reply-To=%3CCAFN7Y%2BW82bXX-v8mZNAVgtCgnsNejPXeCuev%2Bmd9G-6LY06i3Q%40mail.gmail.com%3E"
       TITLE="[osg-users] Regression caused by OSG_PROVIDE_READFILE change">robert.osfield at gmail.com
       </A><BR>
    <I>Sat Mar 26 07:22:08 PDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="278828.html">[osg-users] Regression caused by OSG_PROVIDE_READFILE change
</A></li>
        <LI>Next message: <A HREF="002607.html">[osg-users] Regression caused by OSG_PROVIDE_READFILE change
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2606">[ date ]</a>
              <a href="thread.html#2606">[ thread ]</a>
              <a href="subject.html#2606">[ subject ]</a>
              <a href="author.html#2606">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi James,

Sorry to hear there is a regression.  I've looked at your explanation and
the code you linked to, and the relevant osg::StateSet::set*() methods and
can't spot anything obvious wrong.


One debug test would be to write out the subgraph that the CanvasImage
class creates to a .osgt file and then have a look at the results to see if
it makes sense.  You could compare the subgraph generated by the OSG before
OSG_PROVIDE_READFILE change.  If there are differences then it points to an
issue with one of set methods, and potentially even the exact method that
is a problem.

Robert.





On 26 March 2016 at 11:24, James Turner &lt;<A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">zakalawe at mac.com</A>&gt; wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I&#8217;m seeing a bug with both master
</I>&gt;<i> (c202e4c37276e56caf650684b92a2d83f5dd5a74) and the tip of the 3.4.0 branch
</I>&gt;<i> (f33c58b2f1899b1328b25956ae49e97e6b85097b), where a particular textured
</I>&gt;<i> quad fails to display its texture since the OSG_PROVIDE_READFILE change was
</I>&gt;<i> made.
</I>&gt;<i>
</I>&gt;<i> I&#8217;ve done a history bisect to prove to my satisfaction that this change
</I>&gt;<i> caused the problem, and I see there&#8217;s been a couple of follow up fixes:
</I>&gt;<i> especially the fix in commit b07cbc2ca8bbb13fa568eb11623aa6fe22479183 from
</I>&gt;<i> Jannik Heller about StateSet setAttributeAndModes.
</I>&gt;<i>
</I>&gt;<i> However even with those fixes applied, I&#8217;m still see a white rectangle
</I>&gt;<i> where previously there was a textured rectangle. I&#8217;ve verified the
</I>&gt;<i> osg::Image is loaded correctly, and adjusted my code to use ref-ptrs /
</I>&gt;<i> osgDB::readRefImageFile in case this made any difference, but nothing has
</I>&gt;<i> helped so far. The issue is reproducible on at least Windows, Mac and Linux.
</I>&gt;<i>
</I>&gt;<i> I&#8217;ve also reviewed the large OSG_PROVIDE_READFILE change, and I don&#8217;t see
</I>&gt;<i> any functional changes, especially since I&#8217;m using the default value of
</I>&gt;<i> OSG_PROVIDE_READFILE.
</I>&gt;<i>
</I>&gt;<i> My guess is one of the templates added, is causing some alternative code
</I>&gt;<i> path to be taken that&#8217;s upsetting something in the image -&gt; texture -&gt;
</I>&gt;<i> stateset logic.
</I>&gt;<i>
</I>&gt;<i> Any debugging / investigation suggestions to figure this out would be most
</I>&gt;<i> appreciated. Unfortunately I don&#8217;t have a minimal test case, the code is
</I>&gt;<i> deeply embedded inside FlightGear&#8217;s support library, SimGear. You can see
</I>&gt;<i> what I guess are the most relevant part here:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://sourceforge.net/p/flightgear/simgear/ci/next/tree/simgear/canvas/elements/CanvasImage.cxx#l112">https://sourceforge.net/p/flightgear/simgear/ci/next/tree/simgear/canvas/elements/CanvasImage.cxx#l112</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://sourceforge.net/p/flightgear/simgear/ci/next/tree/simgear/canvas/elements/CanvasImage.cxx#l466">https://sourceforge.net/p/flightgear/simgear/ci/next/tree/simgear/canvas/elements/CanvasImage.cxx#l466</A>
</I>&gt;<i>
</I>&gt;<i> Nothing in this file has changed in nearly a year, and works fine with OSG
</I>&gt;<i> 3.2 / prior to the problem commit on the on 3.4.0 branch.
</I>&gt;<i>
</I>&gt;<i> Any help or debugging suggestions gratefully received!
</I>&gt;<i>
</I>&gt;<i> Kind regards,
</I>&gt;<i> James
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> osg-users mailing list
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">osg-users at lists.openscenegraph.org</A>
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="../attachments/20160326/58233209/attachment-0003.html">http://lists.openscenegraph.org/pipermail/osg-users-openscenegraph.org/attachments/20160326/58233209/attachment-0003.htm</A>&gt;
</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="278828.html">[osg-users] Regression caused by OSG_PROVIDE_READFILE change
</A></li>
	<LI>Next message: <A HREF="002607.html">[osg-users] Regression caused by OSG_PROVIDE_READFILE change
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2606">[ date ]</a>
              <a href="thread.html#2606">[ thread ]</a>
              <a href="subject.html#2606">[ subject ]</a>
              <a href="author.html#2606">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

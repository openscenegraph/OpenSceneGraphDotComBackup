<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] Pass an osg::Texture2D to CUDA driver api
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Pass%20an%20osg%3A%3ATexture2D%20to%20CUDA%20driver%20api&In-Reply-To=%3C1466769628.m2f.67782%40forum.openscenegraph.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003390.html">
   <LINK REL="Next"  HREF="003486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] Pass an osg::Texture2D to CUDA driver api</H1>
<!--htdig_noindex-->
    <B>Philipp Meyer</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20Pass%20an%20osg%3A%3ATexture2D%20to%20CUDA%20driver%20api&In-Reply-To=%3C1466769628.m2f.67782%40forum.openscenegraph.org%3E"
       TITLE="[osg-users] Pass an osg::Texture2D to CUDA driver api">philipp.meyer at fh-bielefeld.de
       </A><BR>
    <I>Fri Jun 24 05:00:28 PDT 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="003390.html">[osg-users] Pass an osg::Texture2D to CUDA driver api
</A></li>
        <LI>Next message: <A HREF="003486.html">[osg-users] Pass an osg::Texture2D to CUDA driver api
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3478">[ date ]</a>
              <a href="thread.html#3478">[ thread ]</a>
              <a href="subject.html#3478">[ subject ]</a>
              <a href="author.html#3478">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi Robert,

thanks for the input!
When thinking about this, I really want to find another approach than the &quot;main loop&quot; because I need to execute the CUDA code at a very specific point in time. (After a RTT Camera Texture has been written, but prior to rendering another texture).

Therefore, I think I cannot use a camera postDrawCallback, because that doesnt solve the problem of displaying the CUDA output after it has been produced in the same frame.

My idea was to create a &quot;fake&quot; drawable node and use a DrawCallback together with renderBins to make my custom CUDA code execute at a very specific time during rendering traversal.

However, I'm having trouble getting that approach to work. If I create a very simple scene graph, only consisting of a root node and 10 of my custom drawable nodes attached to it, each with another render bin number, the execution order of my drawCallbacks does not follow the renderbin number. Instead, the drawCallbacks always execute in the same order that I have added the drawables to the root node.

Does anyone know why that happens? From my understanding, the renderbin number should determine the order of draw (and therefore also of the drawCallback?) operations.


robertosfield wrote:
&gt;<i> Hi Philipp
</I>&gt;<i> 
</I>&gt;<i> On 15 June 2016 at 14:48, Philipp Meyer &lt;&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; figured it out.
</I>&gt;<i> &gt; One needs to use
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Code:
</I>&gt;<i> &gt; viewer-&gt;setReleaseContextAtEndOfFrameHint(false);
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; to prevent the context from getting released after a frame is rendered.
</I>&gt;<i> &gt; That way, its resources, like textures, can still be accessed after the frame completes.
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> I don't have CUDA experience so can't comment on this specifically.
</I>&gt;<i> 
</I>&gt;<i> On the OSG side the setReleaseContextAtEndOfFrameHint() is only useful
</I>&gt;<i> in when you have a single graphics context and are running your
</I>&gt;<i> application SingleThreaded.
</I>&gt;<i> 
</I>&gt;<i> There will be other ways to integrate CUDA rather than via the main
</I>&gt;<i> loop.  You should be able to create a custom GraphicsOperation and
</I>&gt;<i> attach this to a GraphicsWidnow or Camera draw callback to invoke the
</I>&gt;<i> CUDA side from within a thread that has the graphics context current.
</I>&gt;<i> 
</I>&gt;<i> Robert.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> osg-users mailing list
</I>&gt;<i> 
</I>&gt;<i> <A HREF="../../../listinfo.cgi/osg-users-openscenegraph.html">http://lists.openscenegraph.org/listinfo.cgi/osg-users-openscenegraph.org</A>
</I>&gt;<i> 
</I>&gt;<i>  ------------------
</I>&gt;<i> Post generated by Mail2Forum
</I>

------------------
Read this topic online here:
<A HREF="../../../../forum.openscenegraph.org/viewtopic8fe0.php?p=67782#67782">http://forum.openscenegraph.org/viewtopic.php?p=67782#67782</A>






</PRE>

<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003390.html">[osg-users] Pass an osg::Texture2D to CUDA driver api
</A></li>
	<LI>Next message: <A HREF="003486.html">[osg-users] Pass an osg::Texture2D to CUDA driver api
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3478">[ date ]</a>
              <a href="thread.html#3478">[ thread ]</a>
              <a href="subject.html#3478">[ subject ]</a>
              <a href="author.html#3478">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] [Help] OSG + ArKit: Problem converting coordinate system
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20%5BHelp%5D%20OSG%20%2B%20ArKit%3A%20Problem%20converting%20coordinate%20system&In-Reply-To=%3C1539025684.m2f.75048%40forum.openscenegraph.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="009235.html">
   <LINK REL="Next"  HREF="009239.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] [Help] OSG + ArKit: Problem converting coordinate system</H1>
<!--htdig_noindex-->
    <B>Rodrigo Brayner Lyra</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20%5BHelp%5D%20OSG%20%2B%20ArKit%3A%20Problem%20converting%20coordinate%20system&In-Reply-To=%3C1539025684.m2f.75048%40forum.openscenegraph.org%3E"
       TITLE="[osg-users] [Help] OSG + ArKit: Problem converting coordinate system">rbl2 at cin.ufpe.br
       </A><BR>
    <I>Mon Oct  8 12:08:04 PDT 2018</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009235.html">[osg-users] osgshxtext
</A></li>
        <LI>Next message (by thread): <A HREF="009239.html">[osg-users] [Help] OSG + ArKit: Problem converting coordinate system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9237">[ date ]</a>
              <a href="thread.html#9237">[ thread ]</a>
              <a href="subject.html#9237">[ subject ]</a>
              <a href="author.html#9237">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi,

I'm working on a project that will render a scene using openscenegraph, and the user will have the option to work with this scene in AR. The integration of ArKit in the application is almost complete, except in the conversion of ArKit's view matrix to the coordinate system used by OSG. 

I uploaded the render of the OSG axis helper and the ArKit axis helper. As you can see, the y in OSG is x in ArKit, the x in OSG is z in ArKit and the z in OSG is y in ArKit. With that, I thought that if I switched the axes directly into the view matrix it would be correct. What I have tried can be seen in the two attachments with the code fragment that converts the ArKit view matrix into an OSG view matrix (ar_conv_vector_change and ar_conv_values_change). 
None of them worked completely except that one of them was correct in the rotations and translations of the camera, but the position and initial rotation of the scene was completely wrong (The wall should be in the same position and point of view as before at the time that the AR mode is started, but was positioned as shown in the switched_values_view image).

In the end, the camera view matrix is:
m_camera_matrix = m_camera_view * ar_view_matrix;

I apologize for the long text, and I ask the support of the people of this forum, and if there is, who has already gone through this situation (with ArKit or other APIs)

Thank you!

Cheers,
Rodrigo

------------------
Read this topic online here:
<A HREF="http://forum.openscenegraph.org/viewtopic.php?p=75048#75048">http://forum.openscenegraph.org/viewtopic.php?p=75048#75048</A>




Attachments: 
<A HREF="http://forum.openscenegraph.org//files/switched_values_view_100.jpg">http://forum.openscenegraph.org//files/switched_values_view_100.jpg</A>
<A HREF="http://forum.openscenegraph.org//files/ar_conv_values_change_120.jpeg">http://forum.openscenegraph.org//files/ar_conv_values_change_120.jpeg</A>
<A HREF="http://forum.openscenegraph.org//files/ar_conv_vector_change_297.jpeg">http://forum.openscenegraph.org//files/ar_conv_vector_change_297.jpeg</A>
<A HREF="http://forum.openscenegraph.org//files/osg_axis_731.png">http://forum.openscenegraph.org//files/osg_axis_731.png</A>
<A HREF="http://forum.openscenegraph.org//files/arkit_axis_176.jpg">http://forum.openscenegraph.org//files/arkit_axis_176.jpg</A>


</PRE>







<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009235.html">[osg-users] osgshxtext
</A></li>
	<LI>Next message (by thread): <A HREF="009239.html">[osg-users] [Help] OSG + ArKit: Problem converting coordinate system
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9237">[ date ]</a>
              <a href="thread.html#9237">[ thread ]</a>
              <a href="subject.html#9237">[ subject ]</a>
              <a href="author.html#9237">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [osg-users] getting the world coordinate by screen coordinate in a sky shpere
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20getting%20the%20world%20coordinate%20by%20screen%20coordinate%20in%20a%0A%20sky%20shpere&In-Reply-To=%3C1546912711.m2f.75410%40forum.openscenegraph.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <LINK REL="Previous"  HREF="009592.html">
   <LINK REL="Next"  HREF="009562.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[osg-users] getting the world coordinate by screen coordinate in a sky shpere</H1>
<!--htdig_noindex-->
    <B>Qi Liu</B> 
    <A HREF="mailto:osg-users%40lists.openscenegraph.org?Subject=Re%3A%20%5Bosg-users%5D%20getting%20the%20world%20coordinate%20by%20screen%20coordinate%20in%20a%0A%20sky%20shpere&In-Reply-To=%3C1546912711.m2f.75410%40forum.openscenegraph.org%3E"
       TITLE="[osg-users] getting the world coordinate by screen coordinate in a sky shpere">748503128 at qq.com
       </A><BR>
    <I>Mon Jan  7 17:58:31 PST 2019</I>
    <P><UL>
        <LI>Previous message (by thread): <A HREF="009592.html">[osg-users] Deleting still referenced object
</A></li>
        <LI>Next message (by thread): <A HREF="009562.html">[osg-users] setViewMatrixAsLookAt not working to set the initial camera position
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9561">[ date ]</a>
              <a href="thread.html#9561">[ thread ]</a>
              <a href="subject.html#9561">[ subject ]</a>
              <a href="author.html#9561">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--/htdig_noindex-->
<!--beginarticle-->
<PRE>Hi,all

    I am a new to osg and I use the following method to get the world  coordinate by screen corrdiante and it works well: 
osg::Matrix VPW = viewer-&gt;getCamera()-&gt;getViewMatrix() *
viewer-&gt;getCamera()-&gt;getProjectionMatrix() *viewer-&gt;
getCamera()-&gt;getViewport()_&gt;computeWindowMatrix();
osg::Matrix Inm = osg::Matrix::inverse(VPW);
osg::Vec3d world = (osg::Vec3d(pos.x(), pos.y(), 0)) * Inm;

My scene is quite sample,the root has only one child:
root-&gt;addchild(osgDB::readNodeFile(&quot;cow.osg&quot;));


When i add a big sky shpere that surrounds the cow,scene changing to:
    root-&gt;addchild(osgDB::readNodeFile(&quot;cow.osg&quot;)); 
    osg::ref_ptr&lt;osg::Drawable&gt; drawable = new osg::ShapeDrawable(new osg::Sphere(osg::Vec3(0.0f, 0.0f, 0.0f), 100));
   osg::ref_ptr&lt;osg::Geode&gt; geode = new osg::Geode;
   geode-&gt;addDrawable(drawable.get());
   root-&gt;addchild(geode);

I cannot get the right world  coordinate when my camera move inside the sphere by the above method. 

Did I miss something?Is there some way to  ignore the sphere and then to get the world coordinate by screen coordinate?
 
If anyone could point me in the right direction with some simple code,it is very much appreciated. Thanks a lot!

Thank you!

Cheers,
Qi :D

------------------
Read this topic online here:
<A HREF="http://forum.openscenegraph.org/viewtopic.php?p=75410#75410">http://forum.openscenegraph.org/viewtopic.php?p=75410#75410</A>





</PRE>











































<!--endarticle-->
<!--htdig_noindex-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message (by thread): <A HREF="009592.html">[osg-users] Deleting still referenced object
</A></li>
	<LI>Next message (by thread): <A HREF="009562.html">[osg-users] setViewMatrixAsLookAt not working to set the initial camera position
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#9561">[ date ]</a>
              <a href="thread.html#9561">[ thread ]</a>
              <a href="subject.html#9561">[ subject ]</a>
              <a href="author.html#9561">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="../../../listinfo.cgi/osg-users-openscenegraph.html">More information about the osg-users
mailing list</a><br>
<!--/htdig_noindex-->
</body></html>
